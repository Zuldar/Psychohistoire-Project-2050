name: Mise √† jour Mensuelle Psychohistoire

on:
  # 1. D√©clenchement automatique le 1er de chaque mois √† 08:00 UTC
  schedule:
    - cron: '0 8 1 * *'
  # 2. Bouton manuel pour tester quand tu veux (onglet "Actions")
  workflow_dispatch:

permissions:
  contents: write

jobs:
  run-model:
    runs-on: ubuntu-latest
    
    steps:
    # √âtape 1 : Le robot t√©l√©charge ton code
    - name: üì• R√©cup√©ration du d√©p√¥t
      uses: actions/checkout@v3

    # √âtape 2 : Le robot installe Python
    - name: üêç Installation de Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    # √âtape 3 : Le robot lance le calcul
    - name: üß† Ex√©cution du mod√®le Psychohistorique
      run: |
        python src/main_analyzer.py

    # √âtape 4 : Le robot sauvegarde les r√©sultats sur ton GitHub
    - name: üíæ Commit et Push des r√©sultats
      run: |
        git config --global user.name 'Psychohistory Bot'
        git config --global user.email 'bot@psychohistory.com'
        git add data/current_state.json reports/
        git commit -m "üîÆ Mise √† jour mensuelle automatique" || echo "Aucun changement √† valider"
        git
        push
